<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lemma 5 - LM Theory</title>
    <link rel="stylesheet" href="assets/css/styles.css">
    
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
    window.MathJax = {
        loader: {load: ['[tex]/mathtools']},
        tex: {
            tags: 'all',  // Automatically number all display equations
            // loader: {load: ['[tex]/autoload']},               // TODO: remove
            // packages: {'[+]': ['autoload', 'mathtools']},     // TODO: remove
            packages: {'[+]': ['mathtools']},
            autoload: {
                coloneqq: ['mathtools']
            },
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            macros: {
                emph: ["\\textit{#1}", 1],
mathds: ["\\mathbf{#1}", 1],
bm: ["\\boldsymbol{\\mathbf{#1}}", 1],
Tr: "\\operatorname{Tr}",
softmaxOp: "\\operatorname{softmax}",
lip: "\\operatorname{Lip}",
diag: "\\operatorname{diag}",
spaces: "\\hspace{2mm}",
unif: "\\pazocal{U}",
softmax: ["\\softmaxOp\\left(#1\\right)", 1],
norm: ["\\left\\lVert#1\\right\\rVert", 1],
andriy: ["\\textcolor{blue}{[AM: #1]}", 1],
hyunjik: ["\\textcolor{red}{[HK: #1]}", 1],
george: ["\\textcolor{magenta}{[George: #1]}", 1]

            },
        },
        options: {
            renderActions: {
                addMenu: []
            },
            ignoreHtmlClass: "tex2jax_ignore",
            skipHtmlTags: ["script", "noscript", "style", "textarea", "pre", "code"]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <header>
        <h1>Theoretical Results on Transformers and Language Models</h1>
        <nav>
            <a href="/index.html">Home</a>
            <a href="/examples.html">Examples</a>
            <a href="/contact.html">Contact</a>
            <a href="/contribute.html">Contribute</a>
            <div class="hover-container">
                <span class="hover-word"><a href="/library/index.html">Index</a></span>
                <div class="dropdown-content">
                    <a href="/library/index.html">Full Index</a>
                    <a href="/library/papers/index.html">Papers</a>
                    <a href="/library/definitions/index.html">Definitions</a>
                    <a href="/library/axioms/index.html">Axioms</a>
                    <a href="/library/lemmas/index.html">Lemmas</a>
                    <a href="/library/theorems/index.html">Theorems</a>
                    <a href="/library/corollaries/index.html">Corollaries</a>
                </div>
            </div>
        </nav>
    </header>
    <main>
        
<section id="Low-Rank Approximation Bound">
    <h2>Lemma 5: Low-Rank Approximation Bound</h2>
    <section id="Statement">
        <h3>Statement</h3>
        <div>
            $\sum_j \|P_{ij}(\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k)(\mathbf{y}_i - \mathbf{y}_j)^\top\|_\infty \leq  \phi^{-1}(N-1) \sqrt{D/H}$.
        </div>
    </section>
    <section id="motivation">
        <h3>Motivation of Statement (AI-Generated)</h3>
        <div>
            This inequality is useful in the context of high-dimensional data analysis and machine learning, particularly in the study of the stability and robustness of algorithms. It provides a bound on the influence of individual data points on the overall system, which is crucial for understanding the behavior of algorithms under perturbations or noise. Use this inequality when you need to ensure that your model or algorithm remains stable and performs reliably even when subjected to small changes in the input data.
        </div>
    </section>
        
<section id="OriginalProof">
<h3>Original Proof</h3>
Note $\|\mathbf{u}\mathbf{v}^\top\|_{\infty} = \|\mathbf{u}\|_{\infty} \|\mathbf{v}\|_1$ for real vectors $\mathbf{u},\mathbf{v}$. Hence
\begin{align*}
    \sum_j \|P_{ij}(\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k)(\mathbf{y}_i - \mathbf{y}_j)^\top\|_\infty & = \sum_j P_{ij} \|\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k\|_\infty \|\mathbf{y}_i - \mathbf{y}_j\|_1 \\
    & = \mathbf{a}^\top \mathbf{b} \leq \|\mathbf{a}\|_2 \|\mathbf{b}\|_2,
\end{align*}
where $a_j = \sqrt{P_{ij}} \|\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k\|_\infty$, $b_j = \sqrt{P_{ij}} \|\mathbf{y}_i - \mathbf{y}_j\|_1$.

Note $a_j \leq c_j \coloneqq  \sqrt{P_{ij}} \|\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k\|_2$ since $\|\mathbf{u}\|_\infty \leq \|\mathbf{u}\|_2$ for vector $\mathbf{u}$. Hence $\|\mathbf{a}\|_2 \leq \|\mathbf{c}\|_2$.

Also $b_j \leq \sqrt{\frac{D}{H}} d_j \coloneqq  \sqrt{\frac{D}{H}} \sqrt{P_{ij}} \|\mathbf{y}_i - \mathbf{y}_j\|_2$ since $\|\mathbf{u}\|_1 \leq \sqrt{\frac{D}{H}}\|\mathbf{u}\|_2$ for $\mathbf{u} \in \mathbb{R}^{D/H}$ (e.g.~by the Cauchy--Schwartz inequality on $[|\mathbf{u}_1|, \ldots, |\mathbf{u}_{D/H}|]$ and $\mathds{1}$). Hence $\|b\|_2 \leq \sqrt{\frac{D}{H}}\|d\|_2$.

Note $\|c\|_2^2 = \sum_j P_{ij} \|y_j - \sum_k P_{ik} y_k\|_2^2 = \Tr(\mathrm{Cov}(\mathbb{Y})) \leq \phi^{-1}(N-1)$ from Lemma <a href="library/lemmas/lemma_3/index.html#lemma%3Akey">Lemma 3</a>,
and $\|d\|_2^2 =  \sum_j P_{ij} \|y_i - y_j\|_2^2 \leq  \phi^{-1}(N-1)$ also from Lemma <a href="library/lemmas/lemma_3/index.html#lemma%3Akey">Lemma 3</a>.
Hence $\|a\|_2 \|b\|_2 \leq \sqrt{\frac{D}{H}} \|c\|_2 \|d\|_2 \leq \sqrt{\frac{D}{H}} \phi^{-1}(N-1)$.
</section>

    <section id="proofExplanation">
        <h4>Explanation of Proof (AI-Generated)</h4>
        <div>
            To understand the proof, let's break it down into several steps:
<br>
<br>1. <i>Infinity Norm of Outer Product</i>: The proof starts by noting that the infinity norm of the outer product of two real vectors \(\mathbf{u}\) and \(\mathbf{v}\) is given by:
<br>   \[
   \|\mathbf{u}\mathbf{v}^\top\|_{\infty} = \|\mathbf{u}\|_{\infty} \|\mathbf{v}\|_1
   \]
<br>
<br>2. <i>Summation and Norms</i>: Using the above property, the proof considers the sum involving \(P_{ij}\) and the norms of vectors \(\mathbf{y}_j\), \(\mathbf{y}_i\), and \(\mathbf{y}_k\):
<br>   \[
   \sum_j \|P_{ij}(\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k)(\mathbf{y}_i - \mathbf{y}_j)^\top\|_\infty = \sum_j P_{ij} \|\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k\|_\infty \|\mathbf{y}_i - \mathbf{y}_j\|_1
   \]
<br>
<br>3. <i>Vector Definitions</i>: The proof introduces vectors \(\mathbf{a}\) and \(\mathbf{b}\) defined as:
<br>   \[
   a_j = \sqrt{P_{ij}} \|\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k\|_\infty, \quad b_j = \sqrt{P_{ij}} \|\mathbf{y}_i - \mathbf{y}_j\|_1
   \]
<br>
<br>4. <i>Inner Product and Cauchy-Schwarz</i>: The inner product \(\mathbf{a}^\top \mathbf{b}\) is then considered and bounded using the Cauchy-Schwarz inequality:
<br>   \[
   \mathbf{a}^\top \mathbf{b} \leq \|\mathbf{a}\|_2 \|\mathbf{b}\|_2
   \]
<br>
<br>5. <i>Bounding \(\mathbf{a}\)</i>: The proof shows that \(a_j \leq c_j\) where:
<br>   \[
   c_j \coloneqq  \sqrt{P_{ij}} \|\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k\|_2
   \]
<br>   This follows from the property \(\|\mathbf{u}\|_\infty \leq \|\mathbf{u}\|_2\) for any vector \(\mathbf{u}\). Hence, \(\|\mathbf{a}\|_2 \leq \|\mathbf{c}\|_2\).
<br>
<br>6. <i>Bounding \(\mathbf{b}\)</i>: Similarly, \(b_j \leq \sqrt{\frac{D}{H}} d_j\) where:
<br>   \[
   d_j \coloneqq  \sqrt{\frac{D}{H}} \sqrt{P_{ij}} \|\mathbf{y}_i - \mathbf{y}_j\|_2
   \]
<br>   This follows from the property \(\|\mathbf{u}\|_1 \leq \sqrt{\frac{D}{H}}\|\mathbf{u}\|_2\) for \(\mathbf{u} \in \mathbb{R}^{D/H}\). Hence, \(\|\mathbf{b}\|_2 \leq \sqrt{\frac{D}{H}}\|\mathbf{d}\|_2\).
<br>
<br>7. <i>Bounding \(\|\mathbf{c}\|_2\) and \(\|\mathbf{d}\|_2\)</i>: The proof uses Lemma 3 to bound \(\|\mathbf{c}\|_2^2\) and \(\|\mathbf{d}\|_2^2\):
<br>   \[
   \|c\|_2^2 = \sum_j P_{ij} \|y_j - \sum_k P_{ik} y_k\|_2^2 = \Tr(\mathrm{Cov}(\mathbb{Y})) \leq \phi^{-1}(N-1)
   \]
<br>   \[
   \|d\|_2^2 =  \sum_j P_{ij} \|y_i - y_j\|_2^2 \leq  \phi^{-1}(N-1)
   \]
<br>
<br>8. <i>Final Bound</i>: Combining the above results, the proof concludes with:
<br>   \[
   \|\mathbf{a}\|_2 \|\mathbf{b}\|_2 \leq \sqrt{\frac{D}{H}} \|\mathbf{c}\|_2 \|\mathbf{d}\|_2 \leq \sqrt{\frac{D}{H}} \phi^{-1}(N-1)
   \]
        </div>
    </section>




    <section id="Reference">
        <h3>Reference</h3>
            <p>Title: <a href="/library/papers/895bbef7-305d-4454-850a-7279bb832d9d/index.html"></a></p>
            <p>Authors: []</p>
            <p>URL: <a href="https://arxiv.org/abs/2006.04710">https://arxiv.org/abs/2006.04710</a></p>
    </section>
    <section id="Resources">
        <!-- Bibtex Modal -->
        <div id="bibtexModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBibtexModal()">&times;</span>
            <p></p>
            <button class="modal-button" onclick="copyBibtex()">Copy</button>
        </div>
        </div>

        <!-- Latex Modal -->
        <div id="latexModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLatexModal()">&times;</span>
            <p class="tex2jax_ignore"><code>\begin{lemma} \label{lemma:low_rank}
$\sum_j \|P_{ij}(\mathbf{y}_j - \sum_k P_{ik} \mathbf{y}_k)(\mathbf{y}_i - \mathbf{y}_j)^\top\|_\infty \leq  \phi^{-1}(N-1) \sqrt{D/H}$.
\end{lemma}</code></p>
            <button class="modal-button" onclick="copyLatex()">Copy</button>
        </div>
        </div>

        <h3>Resources</h3>    
            <p>
                <b>BibTex</b>:
                    <button onclick="copyBibtex()">Copy</button>
                    <button onclick="openBibtexModel()">Show</button>
            </p>
            <p>
                <b>LaTeX</b>:
                    <button onclick="copyLatex()">Copy</button>
                    <button onclick="openLatexModal()">Show</button>
            </p>
        <script>
            function copyBibtex() {
                var textToCopy = ``;
                navigator.clipboard.writeText(textToCopy).then(function() {
                    //alert('Text copied to clipboard: ' + textToCopy);
                }, function(err) {
                    console.error('Failed to copy text: ', err);
                });
            }
            
            function copyLatex() {
                var textToCopy = `\\begin{lemma} \\label{lemma:low_rank}
$\\sum_j \\|P_{ij}(\\mathbf{y}_j - \\sum_k P_{ik} \\mathbf{y}_k)(\\mathbf{y}_i - \\mathbf{y}_j)^\\top\\|_\\infty \\leq  \\phi^{-1}(N-1) \\sqrt{D/H}$.
\\end{lemma}`;
                navigator.clipboard.writeText(textToCopy).then(function() {
                    //alert('Text copied to clipboard: ' + textToCopy);
                }, function(err) {
                    console.error('Failed to copy text: ', err);
                });
            }

            // Bibtex
            function openBibtexModel() {
                document.getElementById('bibtexModal').style.display = 'block';
            }
            function closeBibtexModal() {
                document.getElementById('bibtexModal').style.display = 'none';
            }

            // Latex
            function openLatexModal() {
                document.getElementById('latexModal').style.display = 'block';
            }
            function closeLatexModal() {
                document.getElementById('latexModal').style.display = 'none';
            }
        </script>
    </section>
</section>

    </main>
    <footer>
        <p>&copy; 2024 Theoretical Results on Transformers and Language Models</p>
    </footer>
</body>
</html>