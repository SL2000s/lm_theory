<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theorem 18 - LM Theory</title>
    <link rel="shortcut icon" href="/assets/images/favicon.png">
    <link rel="stylesheet" href="/assets/css/styles.css">
    
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
    window.MathJax = {
        loader: {load: ['[tex]/mathtools']},
        tex: {
            tags: 'all',  // Automatically number all display equations
            // loader: {load: ['[tex]/autoload']},               // TODO: remove
            // packages: {'[+]': ['autoload', 'mathtools']},     // TODO: remove
            packages: {'[+]': ['mathtools']},
            autoload: {
                coloneqq: ['mathtools']
            },
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            macros: {
                emph: ["\\textit{#1}", 1],
bm: ["\\boldsymbol{\\mathbf{#1}}", 1],
mathds: ["\\mathbf{#1}", 1],
textsl: ["\\textit{#1}", 1],
vspace: ["", 1],
xspace: "",
repOp: "\\operatorname{Rep}",
genOp: "\\operatorname{gen}",
SpanOp: "\\operatorname{Span}",
ConeOp: "\\operatorname{Cone}",
argmin: "\\operatorname{argmin}",
argmax: "\\operatorname{argmax}",
logit: "\\operatorname{logit}",
promptSpace: "\\mathcal{X}",
conceptSpace: "\\mathcal{C}",
repSpace: "\\mathcal{R}",
responseSpace: "\\mathcal{Y}",
defas: ":=",
nullconcept: "\\phi",
conceptDistSpace: "\\mathcal{Q}",
cov: "\\mathrm{Cov}",
yquad: "\\mathcal{Y}",
parnum: "\\bfseries\\P\\arabic{parcount}",
grad: "\\nabla",
prm: "\\:;\\:",
mbw: "\\mb{w}",
mbW: "\\mb{W}",
mbx: "\\mb{x}",
mbX: "\\mb{X}",
mby: "\\mb{y}",
mbY: "\\mb{Y}",
mbz: "\\mb{z}",
mbZ: "\\mb{Z}",
mbT: "\\mb{T}",
mbA: "\\mb{A}",
mba: "\\mb{a}",
mbI: "\\mb{I}",
mbone: "\\mb{1}",
mbL: "\\mb{L}",
mbtheta: "\\mb{\\theta}",
mbTheta: "\\mb{\\Theta}",
mbomega: "\\mb{\\omega}",
mbOmega: "\\mb{\\Omega}",
mbsigma: "\\mb{\\sigma}",
mbSigma: "\\mb{\\Sigma}",
mbphi: "\\mb{\\phi}",
mbPhi: "\\mb{\\Phi}",
mbalpha: "\\mb{\\alpha}",
mbbeta: "\\mb{\\beta}",
mbgamma: "\\mb{\\gamma}",
mbeta: "\\mb{\\eta}",
mbmu: "\\mb{\\mu}",
mbrho: "\\mb{\\rho}",
mblambda: "\\mb{\\lambda}",
mbzeta: "\\mb{\\zeta}",
diag: "\\textrm{diag}",
supp: "\\textrm{supp}",
V: "\\mathbb{V}",
bbH: "\\mathbb{H}",
bbN: "\\mathbb{N}",
bbZ: "\\mathbb{Z}",
bbR: "\\mathbb{R}",
bbS: "\\mathbb{S}",
cL: "\\mathcal{L}",
cD: "\\mathcal{D}",
cN: "\\mathcal{N}",
cT: "\\mathcal{T}",
Gam: "\\textrm{Gam}",
InvGam: "\\textrm{InvGam}",
g: "\\, | \\,",
s: "\\, ; \\,",
indpt: "\\protect\\mathpalette{\\protect\\independenT}{\\perp}",
defeq: "\\coloneqq",
asympeq: "\\ \\sim\\ ",
Reals: "\\mathbb{R}",
Nats: "\\mathbb{N}",
NNReals: "\\Reals_{+}",
exclude: "\\backslash",
eps: "\\varepsilon",
edges: "e",
vertices: "v",
loops: "l",
EE: "\\mathbb{E}",
var: "\\mathrm{var}",
convPr: "\\xrightarrow{\\,p\\,}",
convDist: "\\xrightarrow{\\,d\\,}",
equaldist: "\\overset{d}{=}",
upto: "\\!\\uparrow\\!",
given: "\\mid",
as: "\\textrm{ a.s.}",
equalas: "\\overset{\\mathrm{a.s.}}{=}",
intd: "\\mathrm{d}",
dist: "\\ \\sim\\ ",
distiid: "\\overset{\\mathrm{iid}}{\\dist}",
distind: "\\overset{ind}{\\dist}",
PPDist: "\\mathrm{PP}",
Lebesgue: "\\Lambda",
cdo: "\\mathrm{do}",
normalDist: "\\mathrm{Normal}",
diriDist: "\\mathrm{Diri}",
categDist: "\\mathrm{Cat}",
betaDist: "\\mathrm{Beta}",
bernDist: "\\mathrm{Bern}",
binDist: "\\mathrm{Bin}",
uniDist: "\\mathrm{Uni}",
poiDist: "\\mathrm{Poi}",
gammaDist: "\\mathrm{Gamma}",
multiDist: "\\mathrm{Multi}",
Ind: "\\mathbbm{1}",
p: "    \\stepcounter{parcount}    \\leavevmode\\marginpar[\\hfill\\parnum]{\\parnum}",
independent: "\\protect\\mathpalette{\\protect\\independenT}{\\perp}",
dif: "\\mathop{}\\!\\mathrm{d}",
lmText: ["\\lmOp(\\text{``#1''})", 1],
lm: ["\\lmOp(#1)", 1],
repText: ["\\repOp(\\text{``#1''})", 1],
rep: ["\\repOp(#1)", 1],
ConceptName: ["$\\mathtt{#1}$", 1],
ConceptValue: ["\\texttt{#1}", 1],
SpanText: ["\\SpanOp(\\text{``#1''})", 1],
Span: ["\\SpanOp(#1)", 1],
ConeText: ["\\ConeOp(\\text{``#1''})", 1],
Cone: ["\\ConeOp(#1)", 1],
red: ["\\textcolor{BrickRed}{#1}", 1],
orange: ["\\textcolor{BurntOrange}{#1}", 1],
green: ["\\textcolor{OliveGreen}{#1}", 1],
blue: ["\\textcolor{MidnightBlue}{#1}", 1],
gray: ["\\textcolor{black!60}{#1}", 1],
cdashlinelr: ["  \\noalign{\\vskip\\aboverulesep           \\global\\let\\@dashdrawstore\\adl@draw           \\global\\let\\adl@draw\\adl@drawiv}  \\cdashline{#1}  \\noalign{\\global\\let\\adl@draw\\@dashdrawstore           \\vskip\\belowrulesep}", 1],
defnphrase: ["\\emph{#1}", 1],
abs: ["\\left\\lvert#1 \\right\\rvert", 1],
dtv: ["\\|#1\\|_{\\mathrm{TV}}", 1],
NatSubs: ["\\tilde \\Nats_{#1}", 1],
ConceptDirName: ["\\texttt{#1}\\Rightarrow\\texttt{#2}", 2],
ConceptDirMath: ["#1 \\Rightarrow #2", 2],
ip: ["\\langle #1,#2\\rangle", 2],
E: ["\\mathbb{E}_{#1}\\left[#2\\right]", 2],
checkmark: "\\tikz\\fill[scale=0.4](0,.35) -- (.25,0) -- (1,.7) -- (.25,.15) -- cycle;"

            },
            environments: {
                subequations: ["{", "}"]

            },
        },
        options: {
            renderActions: {
                addMenu: []
            },
            ignoreHtmlClass: "tex2jax_ignore",
            skipHtmlTags: ["script", "noscript", "style", "textarea", "pre", "code"]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <header>
        <h1>Theoretical Results on Transformers and Language Models</h1>
        <nav>
            <a href="/">Home</a>
            <a href="/examples">Examples</a>
            <a href="/contact">Contact</a>
            <div class="hover-container">
                <span class="hover-word"><a href="/contribute">Contribute</a></span>
                <div class="dropdown-content">
                    <a href="/contribute/add_statement">Add statement</a>
                    <a href="/contribute/add_paper">Add paper</a>
                </div>
            </div>
            <!-- <a href="/proof_assistant">Proof Assistant</a> -->
            <div class="hover-container">
                <span class="hover-word"><a href="/library">Index</a></span>
                <div class="dropdown-content">
                    <a href="/library">Full Index</a>
                    <a href="/library/papers">Papers</a>
                    <a href="/library/definitions">Definitions</a>
                    <a href="/library/axioms">Axioms</a>
                    <a href="/library/lemmas">Lemmas</a>
                    <a href="/library/theorems">Theorems</a>
                    <a href="/library/corollaries">Corollaries</a>
                </div>
            </div>
        </nav>
    </header>
    <main>
        
<section id="Simplex Representation Theorem">
    <h2>Theorem 18: Simplex Representation Theorem</h2>
    <section id="Statement">
        <h3>Statement</h3>
        <div>
            Suppose that $\{w_0, \dots, w_{k-1}\}$ is a collection of $k$ mutually exclusive attributes such that for every joint distribution $Q(w_0, \dots w_{k-1})$ there is some $\ell_{i}$ such that $\Pr(W = w_i \given \ell_{i}) = Q(W=w_i)$ for every $i$. Then, the vector representations $\bar\ell_{w_0}, \dots, \bar\ell_{w_{k-1}}$ form a $(k-1)$-simplex in the representation space. In this case, we take the simplex to be the representation of the categorical concept $W = \{w_0, \dots, w_{k-1}\}$.
        </div>
    </section>
    <section id="motivation">
        <h3>Motivation of Statement (AI-Generated)</h3>
        <div>
            This statement is useful in the context of categorical data representation. It ensures that any collection of mutually exclusive attributes can be represented as points on a $(k-1)$-simplex, providing a geometric interpretation of categorical concepts. This is particularly valuable in machine learning and data analysis, where such representations can facilitate the visualization and manipulation of categorical data.
        </div>
    </section>
        
<section id="OriginalProof">
<h3>Original Proof</h3>
If we can represent arbitrary joint distributions, this means, in particular, that we can change the probability of one attribute without changing the relative probability between a pair of other attributes. Consider the case where $k=3$, as illustrated in Figure 6 [in <a href="https://arxiv.org/pdf/2406.01506#figure.caption.18">original paper</a>]. If $\bar\ell_{w_0}, \bar\ell_{w_1}, \bar\ell_{w_2}$ are on a line, then there is no direction in that line (to change the value in the categorical concept) such that adding the direction can change the probability of $w_2$ without changing the relative probabilities between $w_0$ and $w_1$. However, if $\bar\ell_{w_0}, \bar\ell_{w_1}, \bar\ell_{w_2}$ are not on a line, they form a triangle. Then, there exists a line that is toward $\bar\ell_{w_2}$ and perpendicular to the opposite side of the triangle. Now adding the direction $\tilde{\ell}$ can manipulate the probability of $w_2$ without changing the relative probabilities between $w_0$ and $w_1$. That is, for any $\alpha > 0$ and context embedding $\ell$,
\begin{equation}
  \begin{cases}
    \Pr(W = w_2 \given \ell + \alpha \tilde{\ell}) > \Pr(W = w_2 \given \ell), \text{ and}\\
    \frac{\Pr(W = w_1 \given \ell + \alpha \tilde{\ell})}{\Pr(W = w_0 \given \ell + \alpha \tilde{\ell})}  = \frac{\Pr(W = w_1 \given \ell )}{\Pr(W = w_0 \given \ell)}.
  \end{cases}
\end{equation}
Therefore, the vectors $\bar\ell_{w_0}, \bar\ell_{w_1}, \bar\ell_{w_2}$ form a 2-simplex.

This argument extends immediately to higher $k$ by induction. For each $i \in \{0, \dots, k-1\}$, there should exist a direction that is toward $\bar\ell_{w_i}$ and orthogonal to the opposite hyperplane ($(k-2)$-simplex) formed by the other $\bar\ell_{w_{i'}}$'s. Then, the vectors $\bar\ell_{w_0}, \dots, \bar\ell_{w_{k-1}}$ form a $(k-1)$-simplex.
</section>

    <section id="proofExplanation">
        <h4>Explanation of Proof (AI-Generated)</h4>
        <div>
            To understand the proof, let's break it down into several key steps:
<br>
<br>1. <i></i>Arbitrary Joint Distributions<i></i>: The proof starts by assuming that we can represent arbitrary joint distributions. This implies that we can adjust the probability of one attribute independently of the relative probabilities between other attributes.
<br>
<br>2. <i></i>Case for $k=3$<i></i>: The proof considers a specific case where there are three attributes ($k=3$). This is illustrated in a figure (referred to as Figure 6).
<br>
<br>3. <i></i>Attributes on a Line<i></i>: If the vectors $\bar\ell_{w_0}, \bar\ell_{w_1}, \bar\ell_{w_2}$ lie on a straight line, it is impossible to change the probability of $w_2$ without affecting the relative probabilities between $w_0$ and $w_1$.
<br>
<br>4. <i></i>Attributes Forming a Triangle<i></i>: If the vectors $\bar\ell_{w_0}, \bar\ell_{w_1}, \bar\ell_{w_2}$ do not lie on a line, they form a triangle. In this case, there exists a direction towards $\bar\ell_{w_2}$ that is perpendicular to the side of the triangle opposite $\bar\ell_{w_2}$.
<br>
<br>5. <i></i>Manipulating Probabilities<i></i>: By adding a direction $\tilde{\ell}$, we can increase the probability of $w_2$ without changing the relative probabilities between $w_0$ and $w_1$. This is expressed mathematically as:
<br>   \[
   \begin{cases}
     \Pr(W = w_2 \given \ell + \alpha \tilde{\ell}) > \Pr(W = w_2 \given \ell), \text{ and}\\
     \frac{\Pr(W = w_1 \given \ell + \alpha \tilde{\ell})}{\Pr(W = w_0 \given \ell + \alpha \tilde{\ell})}  = \frac{\Pr(W = w_1 \given \ell )}{\Pr(W = w_0 \given \ell)}.
   \end{cases}
   \]
<br>
<br>6. <i></i>Forming a 2-Simplex<i></i>: The vectors $\bar\ell_{w_0}, \bar\ell_{w_1}, \bar\ell_{w_2}$ thus form a 2-simplex (a triangle in 2-dimensional space).
<br>
<br>7. <i></i>Extension to Higher $k$<i></i>: The argument is extended to higher dimensions by induction. For each $i \in \{0, \dots, k-1\}$, there should exist a direction towards $\bar\ell_{w_i}$ that is orthogonal to the opposite hyperplane formed by the other vectors. This means that the vectors $\bar\ell_{w_0}, \dots, \bar\ell_{w_{k-1}}$ form a $(k-1)$-simplex.
<br>
<br>In summary, the proof demonstrates that the vectors representing the attributes form a simplex, allowing for the independent adjustment of probabilities while maintaining relative probabilities between other attributes.
        </div>
    </section>




    <section id="Reference">
        <h3>Reference</h3>
            <p>Title: <a href="/library/papers/the_geometry_of_categorical_and_hierarchical_concepts_in_large_language_models/index.html">The Geometry of Categorical and Hierarchical Concepts in Large Language Models</a></p>
            <p>Authors: Kiho Park, Yo Joong Choe, Yibo Jiang, and Victor Veitch</p>
            <p>URL: <a href="https://arxiv.org/abs/2406.01506">https://arxiv.org/abs/2406.01506</a></p>
    </section>
    <section id="Resources">
        <!-- Bibtex Modal -->
        <div id="bibtexModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBibtexModal()">&times;</span>
            <p>@misc{park2024geometrycategoricalhierarchicalconcepts,<br>&emsp;title={The Geometry of Categorical and Hierarchical Concepts in Large Language Models}, <br>&emsp;author={Kiho Park and Yo Joong Choe and Yibo Jiang and Victor Veitch},<br>&emsp;year={2024},<br>&emsp;eprint={2406.01506},<br>&emsp;archivePrefix={arXiv},<br>&emsp;primaryClass={cs.CL},<br>&emsp;url={https://arxiv.org/abs/2406.01506}}</p>
            <button class="modal-button" onclick="copyBibtex()">Copy</button>
        </div>
        </div>

        <!-- Latex Modal -->
        <div id="latexModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLatexModal()">&times;</span>
            <p class="tex2jax_ignore"><code>\begin{theorem}[Categorical Concepts are Represented as Simplices]
\label{thm:simplex}
  Suppose that $\{w_0, \dots, w_{k-1}\}$ is a collection of $k$ mutually exclusive attributes such that for every joint distribution $Q(w_0, \dots w_{k-1})$ there is some $\ell_{i}$ such that $\Pr(W = w_i \given \ell_{i}) = Q(W=w_i)$ for every $i$.
  Then, the vector representations $\bar\ell_{w_0}, \dots, \bar\ell_{w_{k-1}}$ form a $(k-1)$-simplex in the representation space. In this case, we take the simplex to be the representation of the categorical concept $W = \{w_0, \dots, w_{k-1}\}$.

\end{theorem}</code></p>
            <button class="modal-button" onclick="copyLatex()">Copy</button>
        </div>
        </div>

        <h3>Resources</h3>    
            <p>
                <b>BibTex</b>:
                    <button onclick="copyBibtex()">Copy</button>
                    <button onclick="openBibtexModel()">Show</button>
            </p>
            <p>
                <b>LaTeX</b>:
                    <button onclick="copyLatex()">Copy</button>
                    <button onclick="openLatexModal()">Show</button>
            </p>
        <script>
            function copyBibtex() {
                var textToCopy = `@misc{park2024geometrycategoricalhierarchicalconcepts,
  title={The Geometry of Categorical and Hierarchical Concepts in Large Language Models}, 
  author={Kiho Park and Yo Joong Choe and Yibo Jiang and Victor Veitch},
  year={2024},
  eprint={2406.01506},
  archivePrefix={arXiv},
  primaryClass={cs.CL},
  url={https://arxiv.org/abs/2406.01506}}`;
                navigator.clipboard.writeText(textToCopy).then(function() {
                    //alert('Text copied to clipboard: ' + textToCopy);
                }, function(err) {
                    console.error('Failed to copy text: ', err);
                });
            }
            
            function copyLatex() {
                var textToCopy = `\\begin{theorem}[Categorical Concepts are Represented as Simplices]
\\label{thm:simplex}
  Suppose that $\\{w_0, \\dots, w_{k-1}\\}$ is a collection of $k$ mutually exclusive attributes such that for every joint distribution $Q(w_0, \\dots w_{k-1})$ there is some $\\ell_{i}$ such that $\\Pr(W = w_i \\given \\ell_{i}) = Q(W=w_i)$ for every $i$.
  Then, the vector representations $\\bar\\ell_{w_0}, \\dots, \\bar\\ell_{w_{k-1}}$ form a $(k-1)$-simplex in the representation space. In this case, we take the simplex to be the representation of the categorical concept $W = \\{w_0, \\dots, w_{k-1}\\}$.

\\end{theorem}`;
                navigator.clipboard.writeText(textToCopy).then(function() {
                    //alert('Text copied to clipboard: ' + textToCopy);
                }, function(err) {
                    console.error('Failed to copy text: ', err);
                });
            }

            // Bibtex
            function openBibtexModel() {
                document.getElementById('bibtexModal').style.display = 'block';
            }
            function closeBibtexModal() {
                document.getElementById('bibtexModal').style.display = 'none';
            }

            // Latex
            function openLatexModal() {
                document.getElementById('latexModal').style.display = 'block';
            }
            function closeLatexModal() {
                document.getElementById('latexModal').style.display = 'none';
            }
        </script>
    </section>
</section>

    </main>
    <footer>
        <p>&copy; 2024 Theoretical Results on Transformers and Language Models</p>
    </footer>
</body>
</html>