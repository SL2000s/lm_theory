<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theorem 29 - LM Theory</title>
    <link rel="stylesheet" href="/assets/css/styles.css">
    
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script>
    window.MathJax = {
        loader: {load: ['[tex]/mathtools']},
        tex: {
            tags: 'all',  // Automatically number all display equations
            // loader: {load: ['[tex]/autoload']},               // TODO: remove
            // packages: {'[+]': ['autoload', 'mathtools']},     // TODO: remove
            packages: {'[+]': ['mathtools']},
            autoload: {
                coloneqq: ['mathtools']
            },
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            macros: {
                emph: ["\\textit{#1}", 1],
bm: ["\\boldsymbol{\\mathbf{#1}}", 1],
mathds: ["\\mathbf{#1}", 1],
textsl: ["\\textit{#1}", 1],
xspace: "",
RSIS: "RSI$+$Smooth",
qed: "{\\unskip\\nobreak\\hfil\\penalty50\\hskip2em\\vadjust{}           \\nobreak\\hfil$\\Box$\\parfillskip=0pt\\finalhyphendemerits=0\\par}",
LM: "\\texttt{LMM}\\xspace",
GM: "\\texttt{GMM}\\xspace",
oo: "{11}",
red: "\\textcolor{red}",
blue: "\\textcolor{blue}",
grn: "\\textcolor{darkgreen}",
xat: "\\ob",
rfn: "\\texttt{SVMeq}",
ont: "\\texttt{1token}",
xast: "\\xat^\\st",
Wf: "{\\mtx{W}^\\tsc{fin}}",
noi: "\\noindent",
new: "\\text{new}",
prm: "\\text{prompt}",
TF: "{\\texttt{TF}}",
eps: "\\epsilon",
epsd: "\\varepsilon_\\dm",
dv: "\\rho",
beps: "\\boldsymbol{\\eps}",
bota: "\\boldsymbol{\\iota}",
ept: "\\eps_{\\TF}",
cz: "c_0",
kz: "\\nu",
bxi: "\\boldsymbol{\\xi}",
vsp: "\\vspace",
fnn: "f_{\\text{nn}}",
ff: "f_{\\text{nn}}",
wi: "k_\\st",
hbm: "\\vct{\\bar{h}}",
vc: "\\text{vec}",
flin: "f_{\\text{lin}}",
bhbg: "{\\bar h}_{\\tsc{gap}}",
rest: "\\text{rest}",
hp: "\\tilde{\\mtx{h}}",
Mb: "\\bar{\\M}",
Nb: "\\bar{N}",
epsr: "\\varepsilon_R",
mur: "\\mu_R",
bp: "\\bar{p}",
zig: "\\nu",
bh: "\\bar{h}",
hb: "\\vct{h}",
al: "\\alpha",
als: "\\alpha",
fs: "f^{\\Dc}",
Ncov: "\\mathcal{N}_\\eps(\\Bal)",
ft: "h",
ftv: "f^{\\Tc\\cup\\Vc}",
deff: "h_{\\text{eff}}",
defz: "\\bar{h}_{\\text{eff}}",
deft: "\\tilde{h}_{\\text{eff}}",
defg: "\\bar{h}^{\\nabla}_{\\text{eff}}",
defF: "\\bar{h}^{\\FB}_{\\text{eff}}",
bC: "\\bar{C}",
st: "\\star",
dm: "{\\diamond}",
nt: "n_\\mathcal{T}",
h: "h",
nv: "n_\\mathcal{V}",
distas: "\\overset{\\text{i.i.d.}}{\\sim}",
pleq: "\\overset{{P}}{\\leq}",
np: "{n\\wedge p}",
KB: "\\bar{K}",
bG: "\\boldsymbol{\\Gamma}",
rP: "\\stackrel{{P}}{\\longrightarrow}",
xv: "\\x_{\\vb}",
xa: "\\x^\\bal",
xw: "\\x'_{\\vb}",
xu: "\\x_{\\ub}",
xs: "\\x_{\\ws}",
yst: "\\hat{\\y}",
yb: "\\bar{\\y}",
lnk: "\\psi",
eig: "\\text{eigvec}",
hu: "h",
ru: "r",
pbar: "{{\\bar{p}}}",
pbd: "p",
lan: "\\vct{k}",
cmp: "P_{\\text{nn}}",
dcp: "\\vct{d}^{\\text{cnn}}",
fcp: "\\vct{g}^{\\text{CNN}}",
beq: "\\begin{equation}",
ba: "\\begin{align}",
ea: "\\end{align}",
nrest: "\\bar{n}",
eeq: "\\end{equation}",
prox: "{{\\text{\\bf{prox}}}}",
cov: "{{\\text{\\bf{cov}}}}",
ex: "{{\\text{\\bf{ex}}}}",
modu: "{{\\text{{mod}}}}",
map: "{{\\text{\\bf{map}}}}",
vrn: "\\sigma",
Rcm: "\\Rcc_m",
lowo: "\\texttt{low}_\\oo^{\\alpha}",
tsig: "\\tilde{\\sigma}",
dev: "{{\\text{\\bf{dev}}}}",
meas: "{{\\text{\\bf{mean}}(\\sigma)}}",
nn: "\\nonumber",
la: "\\lambda",
laz: "\\la_0",
blaz: "\\bar{\\la}_0",
caz: "\\la_C",
saz: "L_\\sigma",
smax: "\\bar{\\sigma}_{\\max}",
Lat: "\\tilde{\\Lambda}",
K: "\\mtx{K}",
A: "{\\mtx{A}}",
Aa: "{\\mtx{A}}",
Bb: "{\\mtx{B}}",
N: "{\\mtx{N}}",
amp: "\\alpha_{\\text{cnn}}",
btm: "\\bigotimes",
bd: "\\bigodot",
kapp: "s_{\\max}^{\\nu}",
kal: "\\prod_{i=1}^{D-1}\\tn{\\lay{i}}",
Ub: "{\\mtx{U}}",
Ubb: "{\\mtx{U}}",
kron: "\\otimes",
M: "{\\mtx{M}}",
dimondf: "\\W^\\svm",
name: "Att-SVM",
ten: "(\\{\\vb_\\ell\\}_{\\ell=1}^D)",
uten: "(\\{\\ub_\\ell\\}_{\\ell=1}^D)",
ken: "(\\{\\lay{i}\\}_{i=1}^D)",
B: "{{\\mtx{B}}}",
alx: "{{\\alpha_\\X}}",
Ib: "{{\\mtx{I}}}",
fp: "F",
Xbin: "{{\\mtx{B}}}",
Gbin: "{{\\mtx{S}}}",
xbin: "{{\\mtx{b}}}",
Sb: "{{\\mtx{S}}}",
Sbt: "{\\mathbb{S}}^t",
Sbtt: "{\\mathbb{S}}'^{t}",
Gb: "{\\mtx{G}}",
ymean: "{\\bar{\\y}(\\w;\\text{avg})}",
yavg: "{{y}_{\\text{avg}}}",
fmean: "{\\funcw{\\w;\\text{avg}}}",
out: "\\text{out}",
linest: "\\text{lin}",
inp: "\\text{in}",
inh: "\\hat{\\text{in}}",
sexp: "subexponential ",
Lc: "{\\cal{L}}",
Hc: "{\\cal{H}}",
Lcz: "{\\cal{L}}^{0-1}",
Lczh: "{\\hat{\\cal{L}}}^{0-1}",
Lch: "{\\widehat{\\cal{L}}}",
Lct: "{\\tilde{\\cal{L}}}",
Lcb: "{\\bar{\\cal{L}}}",
Nc: "{\\cal{N}}",
xm: "\\x^{\\tsc{mix}}",
Jc: "{\\cal{J}}",
Dc: "{\\cal{D}}",
Dci: "{\\cal{D}}_{\\text{init}}",
Ro: "{\\cal{RO}}",
PC: "{\\cal{PC}}",
Pb: "{\\mtx{P}}",
Tb: "{\\mtx{T}}",
Tn: "{T_0}",
Kba: "{\\vct{k}}_{\\text{all}}",
Qb: "{\\mtx{Q}}",
QK: "{\\mtx{Q} \\mtx{K}^\\top}",
rng: "\\gamma",
ta: "\\tau",
gmax: "\\gamma^\\star",
ggap: "\\bar{\\gamma}_{\\tsc{gap}}",
Cb: "{\\mtx{C}}",
BC: "{\\bar{C}}",
Eb: "{\\mtx{E}}",
Hb: "{\\mtx{H}}",
Gc: "{\\cal{G}}",
Zc: "{\\cal{Z}}",
F: "{\\mtx{F}}",
Fa: "{\\mtx{F}}^\\bal",
diff: "{\\text{diff}}",
La: "{\\boldsymbol{{\\Lambda}}}",
sigmap: "\\phi'",
sigmaa: "\\sigma'_{\\text{all}}",
bSi: "{\\boldsymbol{{\\Sigma}}}",
bSii: "{\\boldsymbol{{\\Sigma}}}_{i,i}",
bSib: "\\bar{{\\boldsymbol{{\\Sigma}}}}",
bSit: "{\\boldsymbol{{\\tilde{\\Sigma}}}}",
bSih: "{\\boldsymbol{{\\hat{\\Sigma}}}}",
bmu: "{\\boldsymbol{{\\mu}}}",
Db: "{\\mtx{D}}",
bB: "{\\bar{B}}",
tB: "{\\tilde{B}}",
db: "{\\vct{d}}",
oneb: "{\\mathbb{1}}",
onebb: "{\\mathbf{1}}",
Iden: "{\\mtx{I}}",
gm: "\\gamma_m",
OR: "\\text{OR}",
z: "{\\vct{z}}",
zt: "{\\tilde{\\vct{z}}}",
fab: "f^\\bal_\\bt",
zb: "{\\bar{\\z}}",
el: "{\\ell}",
sftx: "\\mathbb{S}",
bad: "{\\bar{d}}",
Lcg: "\\tilde{\\Lc}",
Dp: "{D^+}",
upp: "{\\cal{B}}_{\\alpha,\\Gamma}",
upz: "{\\cal{B}}_{\\alpha_0,\\Gamma}",
dpz: "{\\cal{D}}_{\\alpha_0,\\Gamma}",
dpp: "{\\cal{D}}_{\\alpha,\\Gamma}",
mpp: "M_{\\alpha,\\Gamma}",
paf: "\\partial f(\\x)",
Cc: "\\mathcal{C}",
Rcc: "\\mathcal{R}",
Qcc: "\\mathcal{Q}",
Kcc: "\\mathcal{K}",
Ac: "\\mathcal{A}",
Acg: "\\Ac_g",
At: "\\mathcal{A}",
Acr: "\\mathcal{A_\\text{ridge}}",
Bal: "{\\boldsymbol{\\Delta}}",
pbb: "\\vct{\\bar{p}}",
pbs: "\\tilde{\\pb}^\\svm",
del: "\\delta",
GG: "\\texttt{GG}",
BB: "\\texttt{BB}",
BG: "\\texttt{BG}",
bGam: "\\bar{\\Gamma}_y",
GB: "\\texttt{GB}",
delw: "\\delta_w",
delq: "\\delta_q",
bdel: "\\boldsymbol{\\delta}",
Ccb: "\\bar{\\mathcal{C}}",
Rc: "\\mathcal{O}",
Rcp: "\\mathcal{\\bar{O}}'",
btrue: "\\bbeta_{true}",
bt: "{\\boldsymbol{\\theta}}",
bet: "{\\boldsymbol{\\beta}}",
bT: "\\Theta",
bts: "{\\boldsymbol{\\beta}_\\st}",
btb: "\\bar{\\boldsymbol{\\theta}}",
btid: "\\boldsymbol{\\theta}^\\text{ideal}",
btt: "\\tilde{\\boldsymbol{\\theta}}",
bal: "{\\boldsymbol{\\alpha}}",
bgam: "\\boldsymbol{\\gamma}",
bga: "\\boldsymbol{\\gamma}^\\bal",
gamb: "\\bar{\\gamma}",
bab: "{\\boldsymbol{\\bar{\\alpha}}}",
bah: "{\\widehat{\\bal}}",
berm: "\\bal^{\\texttt{ERM}}",
bas: "{\\boldsymbol{\\alpha}_\\st}",
bth: "{\\boldsymbol{\\hat{\\beta}}}",
bPhi: "{\\boldsymbol{\\Phi}}",
bbteta: "\\widetilde{\\boldsymbol{\\theta}}",
bbeta: "{\\boldsymbol{\\beta}}",
ddelta: "{\\boldsymbol{\\delta}}",
DD: "{D}",
babeta: "{\\bar{\\beta}}",
balpha: "{\\bar{\\alpha}}",
bgamma: "\\gamma^\\star",
agam: "{\\bar{\\gamma}}_t",
No: "N",
Bc: "\\mathcal{B}",
Sc: "\\mathcal{S}",
Scc: "\\bar{\\mathcal{S}}",
Sca: "\\mathcal{S}_{\\text{all}}",
Dca: "\\mathcal{D}_{\\text{all}}",
Scn: "\\mathcal{S}_{\\new}",
Dcn: "\\mathcal{D}_{new}",
Scb: "\\bar{\\mathcal{S}}",
Sci: "\\mathcal{S}_{\\text{in}}",
Sco: "\\mathcal{S}_{\\text{out}}",
Ect: "\\mathcal{S}_{\\text{top}}",
Mc: "\\mathcal{M}",
pa: "{\\partial}",
Nn: "\\mathcal{N}",
pol: "^\\circ",
vb: "\\vct{v}",
Jb: "\\mtx{J}",
Jt: "\\mtx{\\tilde{J}}",
vbl: "\\vct{v}^{\\text{lin}}",
fb: "\\vct{f}",
Fb: "\\vct{F}",
FB: "\\mathbb{F}",
Ft: "\\tilde{\\vct{F}}",
fa: "\\tilde{\\vct{f}}",
ib: "{\\bf{i}}",
hib: "{\\bf{\\hat{i}}}",
Ic: "{\\mathcal{I}}",
all: "{\\text{all}}",
vh: "\\vct{\\hat{v}}",
vbb: "\\vct{\\bar{v}}",
Xb: "\\mtx{\\bar{X}}",
xb: "\\vct{\\bar{x}}",
abb: "\\mtx{\\bar{a}}",
ap: "\\mtx{a}'",
cb: "\\mtx{c}",
cbb: "\\mtx{\\bar{c}}",
kbb: "\\mtx{\\bar{k}}",
bbb: "\\mtx{\\bar{b}}",
nei: "\\text{support index}\\xspace",
neis: "\\text{support indices}\\xspace",
Nei: "\\text{Support index}\\xspace",
Neis: "\\text{Support indices}\\xspace",
NEIS: "\\text{Support Indices}\\xspace",
w: "\\vct{w}",
ww: "\\vct{V}",
lgt: "\\texttt{lgt}'",
ist: "i_\\st",
cdm: "c_\\dm",
cop: "c_\\texttt{up}",
cdn: "c_\\texttt{dn}",
Wp: "\\mtx{W}^\\dagger",
tilW: "\\widetilde{\\mtx{W}}",
tilw: "\\widetilde{\\vct{w}}",
ob: "\\mtx{o}",
obo: "\\mtx{o}_1(t)",
obt: "\\mtx{o}_2(t)",
obh: "\\mtx{\\hat{o}}",
wh: "{\\hat{\\mtx{w}}}",
li: "\\left<",
xdm: "\\Xi_\\dm",
ri: "\\right>",
s: "\\vct{s}",
sik: "\\s^{(\\ik)}",
sir: "\\s^R",
abik: "\\ab^{(\\ik)}",
abr: "\\ab^R",
ab: "{\\vct{a}}",
abm: "\\vct{\\bar{a}}",
abg: "\\vct{a}_{\\tsc{gap}}",
bgag: "{\\gamma}_{\\tsc{gap}}",
bgg: "\\gamma^{\\tsc{gap}}",
bggm: "\\gamma^{\\tsc{gap}}_{\\min}",
bgm: "\\bar{\\gamma}^{\\tsc{gap}}",
abp: "\\vct{a}^\\pb",
bb: "\\vct{b}",
ub: "{\\vct{u}}",
ubb: "\\bar{\\vct{u}}",
hh: "{\\vct{h}}",
ii: "{\\vct{i}}",
dd: "{\\vct{d}}",
ddt: "{\\vct{d}}_\\tau",
Zb: "\\mathbb{Z}",
hf: "\\hat{f}",
corrCA: "\\rho_\\Cc(\\M)",
Tc: "\\mathcal{T}",
Tcb: "\\bar{\\mathcal{T}}",
TVc: "\\Tc\\cup\\Vc",
Ttc: "\\mathcal{T}_{\\text{test}}",
Fc: "\\mathcal{F}",
Fcl: "\\mathcal{F}^{\\text{lin}}",
Xc: "\\mathcal{X}",
Yc: "\\mathcal{Y}",
rel: "optimal\\xspace",
iopt: "non-optimal\\xspace",
irel: "non-optimal\\xspace",
ihere: "{\\textcolor{red}{I AM HERE! }}",
gb: "\\bar{\\g}",
bs: "\\bar{s}",
cgain: "\\alpha_{\\text{CNN}}",
cgainp: "\\tn{\\E_{\\x\\sim\\Nn(0,\\Iden)}[\\gcnn{}]}",
ccorr: "\\rho_{\\text{cnn}}",
kb: "\\vct{k}",
kbo: "\\vct{k}^\\op",
xbo: "\\vct{x}^\\op",
xh: "\\hat{\\x}",
cone: "\\Sc",
conb: "\\bar{\\Cc}",
xbr: "\\bar{\\h}",
low: "\\texttt{low}^{\\alpha}(\\X)",
high: "\\texttt{high}^{\\alpha}(\\X)",
lowi: "\\texttt{low}_\\ik^{\\alpha}",
higi: "\\texttt{high}_\\ik^{\\alpha}",
xdr: "\\tilde{\\x}",
ybt: "\\tilde{\\y}",
Xt: "\\tilde{\\X}",
gh: "\\hat{\\g}",
gt: "\\tilde{\\g}",
ir: "q",
sbs: "\\vct{s}^{\\texttt{ref}}",
bbg: "\\bgam^{\\tsc{gap}}",
bbs: "\\bar{\\s}",
gmb: "\\bar{\\gamma}",
irm: "q^\\pb_{\\max}",
ira: "q^{\\pb'}_{\\max}",
vbs: "\\tilde{\\vb}^\\svm",
vs: "\\vb^\\svm",
ps: "\\W^\\svm",
Ws: "\\W^\\svm",
Wma: "\\W^\\svm_\\bal",
Wsf: "\\W^\\svm",
Wsb: "\\bar{\\W}^\\svm",
Wcs: "\\Wc^\\svm",
ik: "{ik}",
itt: "{it}",
ittt: "{i\\tau}",
ikt: "{ikt}",
iktt: "{ik\\tau}",
ikix: "_{ik=(1,1)}^{(n,k)}",
Ccd: "\\Cc_{\\eps,R_0}^\\dm",
aik: "\\alpha_{ik}",
prr: "\\pb^\\tsc{relax}",
pre: "\\pb^\\tsc{$\\eps$-rlx}",
pbr: "\\tilde{\\pb}^\\tsc{$\\eps$-rlx}",
qbr: "\\tilde{\\qb}^\\tsc{relax}",
pseb: "\\pbb^\\svm_\\eps",
pset: "\\tilde{\\pb}^\\svm_\\eps",
psdb: "\\pbb^\\svm_\\delta",
pse: "\\pb^\\svm_\\eps",
psd: "\\pb^\\svm_\\delta",
pst: "\\pb^\\star",
wst: "\\W^\\star",
gamp: "\\Gamma_\\eps",
gamt: "\\Gamma^{\\geq 2}_\\eps",
damp: "\\Gamma_\\delta",
pt: "\\tilde{\\pb}^\\svm",
RR: "\\bar{R}",
MM: "\\bar{M}",
psb: "\\bar{\\pb}^\\svm",
psp: "\\pb^\\beta",
pso: "\\pb^{\\svm\\star}",
Wso: "\\W^{\\svm\\star}",
mipp: "L_{\\max}",
mupp: "\\bar{\\mu}_{\\max}",
mapp: "\\mu",
tcnn: "{\\mtx{T}}_{\\text{cnn}}",
lcnn: "{\\mtx{L}}_{\\text{CNN}}",
smo: "S",
SM: "{{\\bf{S}}}_{L,\\kb}",
SMB: "{{\\bf{\\bar{S}}}}_{L,\\kb}",
ws: "{\\W^\\star}",
wss: "{\\w^\\star}",
lab: "\\bar{\\la}",
mult: "B^D\\bar{M}N",
liptwo: "20R^3B\\nt^2\\laz^{-2}(B\\nt+1)",
lipp: "5R^2\\sqrt{B^3\\nt^3\\h}\\laz^{-2}\\tn{\\yT}",
lips: "6R^3B^2\\sqrt{\\nt^3\\h}\\laz^{-2}\\tn{\\yT}",
lipl: "5(RB\\nt\\sqrt{\\h}+1)RB\\nt\\laz^{-2}",
lip: "\\frac{5B^2\\tn{\\yT}}{\\laz^2}",
lipt: "6R^3B^2\\Gamma\\sqrt{\\nt^3\\h}\\laz^{-2} \\tn{\\yT}",
lipf: "{20R^4B^2\\laz^{-2}\\Gamma\\nt^2\\tn{\\yT}}",
lipsum: "30R^4B^2\\laz^{-2}\\Gamma(\\nt^2+\\nv^2) \\tn{\\yT}",
lipnn: "120B^4\\blaz^{-2}\\Gamma(\\nt^2+\\nv^2) \\tn{\\yT}",
bL: "\\bar{L}",
scl: "M",
cA: "\\mathcal{A}",
x: "\\vct{x}",
rb: "\\vct{r}",
rbb: "\\vct{\\widetilde{r}}",
y: "\\vct{y}",
yT: "\\vct{y}",
yh: "\\hat{y}",
ybh: "\\vct{\\hat{y}}",
W: "\\mtx{W}",
Wt: "\\tilde{\\mtx{W}}",
Wc: "{\\cal{W}}",
Wcb: "{\\cal{W}}",
Vc: "{\\cal{V}}",
bgl: "{~\\big |~}",
p: "{\\vct{p}}",
Kb: "{\\mtx{K}}",
Kbb: "{\\mtx{\\bar{K}}}",
Qbb: "{\\mtx{\\bar{Q}}}",
Wb: "{\\mtx{\\bar{W}}}",
Wpro: "\\mtx{\\W}_{\\textnormal{prod}}",
Kbh: "{\\widehat{\\mtx{K}}}",
somelog: "16\\Kb\\log (\\Kb)",
somelg: "\\Kb\\log (\\Kb)",
pb: "{\\vct{p}}",
dpb: "{\\vct{\\dot p}}",
drb: "{\\vct{\\dot r}}",
qb: "{\\vct{q}}",
qstar: "\\vct{q}_\\star",
qtt: "{\\vct{\\tilde{q}}}",
wstar: "\\vct{v}_\\star",
vstar: "\\vct{v}_\\star",
wstab: "\\bar{\\vb}_\\star",
vstab: "\\bar{\\vb}_\\star",
qstab: "\\bar{\\qb}_\\star",
qbb: "\\bar{\\qb}",
wbb: "\\bar{\\w}",
wtt: "{\\vct{\\tilde{w}}}",
R: "\\mathbb{R}",
Pro: "\\mathbb{P}",
C: "\\mathbb{C}",
Z: "\\mtx{Z}",
V: "\\mtx{V}",
Za: "\\mtx{Z}^\\bal",
Var: "\\textrm{Var}",
E: "\\operatorname{\\mathbb{E}}",
Eh: "\\operatorname{\\mathbb{\\hat{E}}}",
e: "\\mathrm{e}",
eb: "\\vct{e}",
vba: "{\\bf{\\emph{v}}}",
pba: "{\\bf{\\emph{p}}}",
supp: "\\Sc",
Id: "\\text{\\em I}",
OpId: "\\mathcal{I}",
Real: "\\operatorname{Re}",
Imag: "\\operatorname{Im}",
piyp: "\\pi'_1(\\vct{y})",
piy: "\\pi_1(\\vct{y})",
piar: "\\pi_1(\\vct{a}_r)",
piarp: "\\pi'_1(\\vct{a}_r)",
set: "{\\cal{F}}",
des: "{\\x_0}",
Pc: "{\\cal{P}}",
X: "{\\mtx{X}}",
Y: "{\\mtx{Y}}",
Vb: "{\\mtx{V}}",
Vh: "\\hat{{\\mtx{V}}}",
Vbd: "{\\mtx{V}^\\dagger}",
Rb: "{\\mtx{R}}",
bR: "{\\bar{R}}",
calF: "\\mathcal{I}",
calS: "\\mathcal{N}",
gi: "\\ab_{\\gamma_i}",
ang: "\\text{ang}",
mc: "\\mathcal",
g: "\\vct{g}",
tsc: "\\textsl",
Prml: "\\text{Primal}\\xspace",
cls: "\\texttt{[CLS]}\\xspace",
prml: "\\text{primal}\\xspace",
fat: "f_{\\tsc{sa}}",
fatt: "f_{\\tsc{cls}}",
faptt: "f^\\top_{\\tsc{cls}}",
thetab: "\\boldsymbol{\\theta}",
acc: "\\text{acc}",
svm: "\\tsc{mm}",
Wm: "\\W^\\svm",
Wmt: "\\tilde\\W^\\svm",
Wu: "\\W^{\\texttt{uni}}",
Wbi: "\\W^{\\texttt{bi}}",
Wub: "\\bar{\\W}^{\\texttt{uni}}",
Wbb: "\\bar{\\W}^{\\texttt{bi}}",
op: "\\texttt{opt}",
opt: "\\texttt{opt}",
xop: "\\x^\\texttt{opt}",
reg: "\\tsc{reg}",
vstap: "\\vstar'",
Cbp: "\\Cb'",
Rcb: "\\bar{\\Rc}",
err: "\\texttt{err}",
ones: "\\onebb",
onet: "\\bar{\\onebb}",
taub: "{\\bar{\\tau}}",
taut: "\\tau",
Qc: "{\\cal{Q}}",
tr: "{{\\operatorname{trace}}}",
goodbox: ["\\begin{center} \\begin{tcolorbox}[boxsep=1pt,left=7pt,right=7pt,top=0pt,bottom=2pt,enhanced, width=14cm,colframe=white!3!black,colback=black!2!white,colbacktitle=orange!5!yellow!10!white,fonttitle=\\bfseries,coltitle=black,attach boxed title to top center={yshift=-0.25mm-\\tcboxedtitleheight/2,yshifttext=2mm-\\tcboxedtitleheight/2},boxed title style={boxrule=0.2mm,frame code={ \\path[tcb fill frame] ([xshift=-4mm]frame.west)-- (frame.north west) -- (frame.north east) -- ([xshift=4mm]frame.east)-- (frame.south east) -- (frame.south west) -- cycle; },interior code={ \\path[tcb fill interior] ([xshift=-2mm]interior.west)-- (interior.north west) -- (interior.north east)-- ([xshift=2mm]interior.east) -- (interior.south east) -- (interior.south west)-- cycle;} }] #1 \\end{tcolorbox}\\end{center}", 1],
nicebox: ["\\begin{center} \\begin{tcolorbox}[boxsep=1pt,left=7pt,right=7pt,top=0pt,bottom=2pt,enhanced, width=14cm,colframe=green!3!black,colback=green!3!white,colbacktitle=orange!5!yellow!10!white,fonttitle=\\bfseries,coltitle=black,attach boxed title to top center={yshift=-0.25mm-\\tcboxedtitleheight/2,yshifttext=2mm-\\tcboxedtitleheight/2},boxed title style={boxrule=0.2mm,frame code={ \\path[tcb fill frame] ([xshift=-4mm]frame.west)-- (frame.north west) -- (frame.north east) -- ([xshift=4mm]frame.east)-- (frame.south east) -- (frame.south west) -- cycle; },interior code={ \\path[tcb fill interior] ([xshift=-2mm]interior.west)-- (interior.north west) -- (interior.north east)-- ([xshift=2mm]interior.east) -- (interior.south east) -- (interior.south west)-- cycle;} }] #1 \\end{tcolorbox}\\end{center} ", 1],
redp: ["\\textcolor{red}{[#1]}", 1],
so: ["\\textcolor{darkblue}{#1}", 1],
SO: ["\\textcolor{red}{[SO: #1]\\\\}", 1],
dat: ["\\textcolor{darkgreen}{#1}", 1],
DAT: ["\\textcolor{green}{[DAT: #1]}", 1],
yl: ["\\textcolor{orange}{#1}", 1],
YL: ["\\textcolor{orange}{[YL: #1]}", 1],
ct: ["\\textcolor{magenta}{[CT: #1]}", 1],
todo: ["\\textcolor{darkred}{TODO: #1}", 1],
clr: ["\\red{#1}", 1],
cln: ["\\red{}", 1],
som: ["\\marginpar{\\color{darkblue}\\tiny\\ttfamily SO: #1}", 1],
outr: ["\\text{outer\\_update}(#1)", 1],
cc: ["\\Cc(#1)", 1],
fF: ["f_{\\text{nn},#1}", 1],
fln: ["f_{\\text{lin},#1}", 1],
exc: ["\\mathcal{R}_{\\tsc{gap}}(#1)", 1],
xvt: ["\\x_{\\vb_{#1}}", 1],
xvtt: ["\\x_{\\vb,#1}", 1],
xwt: ["\\x_{#1,\\w}", 1],
xws: ["\\x_{#1,\\ws}", 1],
link: ["\\lnk(#1)", 1],
lay: ["{\\vct{k}}^{(#1)}", 1],
lah: ["{\\vct{\\hat{k}}}^{(#1)}", 1],
bea: ["\\begin{align}#1\\end{align}", 1],
var: ["{{\\text{\\bf{var}}}}[#1]", 1],
sgt: ["\\tilde{\\sigma}^{(#1)}", 1],
func: ["{f_{\\text{CNN}}}(#1)", 1],
funh: ["{{\\hat{f}}_{\\text{CNN}}}(#1)", 1],
funcp: ["{f'_{\\text{cnn}}}(#1)", 1],
funcw: ["{{{f}}'_{\\text{cnn}}}(#1)", 1],
robt: ["\\bigotimes_{\\ell=1}^D{#1}_{\\ell}", 1],
robtu: ["\\bigotimes_{\\ell=1}^D{#1}^{(\\ell)}", 1],
kall: ["1_{\\lan #1}", 1],
lall: ["{\\order{\\lip_{\\lan #1}}}", 1],
lell: ["{\\lip}_{\\lan #1}", 1],
bell: ["{{{\\beta}}}_{\\lan #1}", 1],
aly: ["{{\\alpha_{\\X_{#1}}}}", 1],
ravg: ["{{r}_{{\\text{avg}}}(#1)}", 1],
diag: ["\\text{diag}(#1)", 1],
Lcv: ["{\\cal{L}}^{#1}_{\\text{up}}", 1],
noresamp: ["{\\textcolor{red}{#1}}", 1],
relu: ["\\phi(#1)", 1],
one: ["{\\bm{1}}(#1)", 1],
sigmal: ["\\sigma^{(#1)}", 1],
sigmalp: ["\\sigma'^{(#1)}", 1],
sigmai: ["\\sigma'_{\\text{all},#1}", 1],
order: ["{\\cal{O}}(#1)", 1],
ordet: ["{\\widetilde{\\cal{O}}}(#1)", 1],
rmax: ["{\\bf{r}_{\\max}(#1)}", 1],
rbmax: ["{\\bf{\\bar{r}}_{\\max}(#1)}", 1],
rmin: ["{\\bf{r}_{\\min}(#1)}", 1],
gmmin: ["{\\gamma_{\\min}(#1)}", 1],
gmmax: ["{\\gamma_{\\max}(#1)}", 1],
smn: ["{s_{\\min}(#1)}", 1],
smx: ["{s_{\\max}(#1)}", 1],
isnr: ["\\texttt{ISNR}(#1)", 1],
sft: ["\\mathbb{S}(#1)", 1],
sftk: ["\\mathbb{S}_k(#1)", 1],
sfp: ["\\mathbb{S}'(#1)", 1],
distd: ["\\texttt{dist}_\\dm\\left(#1\\right)", 1],
tn: ["\\|{#1}\\|", 1],
td: ["\\|{#1}\\|_\\dm", 1],
tl: ["\\|{#1}\\|_{L_2}", 1],
ts: ["\\|{#1}\\|_{\\Sc}", 1],
ti: ["\\|{#1}\\|_{\\infty}", 1],
nrm: ["\\|{#1}\\|", 1],
inr: ["\\left<#1\\right>", 1],
tone: ["\\|{#1}\\|_{\\ell_1}", 1],
lix: ["\\|{#1}\\|_{\\Xc}", 1],
lif: ["\\text{dist}_{\\FB}({#1})", 1],
lit: ["\\text{max}(#1)", 1],
lia: ["\\text{avg}(#1)", 1],
lin: ["\\|{#1}\\|_{L_\\infty}", 1],
tff: ["\\|{#1}\\|_{\\ell_4}", 1],
tin: ["\\|{#1}\\|_{\\ell_\\infty}", 1],
trow: ["\\|{#1}\\|_{2,\\infty}", 1],
tf: ["\\|{#1}\\|_{F}", 1],
tnuc: ["\\|{#1}\\|_{\\star}", 1],
te: ["\\|{#1}\\|_{\\psi_1}", 1],
tsub: ["\\|{#1}\\|_{\\psi_2}", 1],
tsut: ["\\|{#1}\\|_{\\psi_{2/3}}", 1],
tsup: ["\\|{#1}\\|_{\\psi_a}", 1],
dist: ["\\texttt{dist}\\left(#1\\right)", 1],
Al: ["\\Ac(#1)", 1],
Alg: ["\\Ac_g(#1)", 1],
sbl: ["\\sigma_{\\boldsymbol{\\alpha^{(#1)}}}", 1],
bl: ["{\\boldsymbol{\\alpha}}^{(#1)}", 1],
blb: ["\\bar{\\boldsymbol{\\alpha}}^{(#1)}", 1],
zm: ["{\\texttt{{{zm}}}[#1]}", 1],
corr: ["{\\texttt{corr\\_coef}}(#1)", 1],
qqq: ["{\\textcolor{red}{?{#1}?}}", 1],
mat: ["{\\text{mat}{#1}}", 1],
gcnn: ["{\\vct{g}}_{\\text{cnn}#1}", 1],
con: ["\\texttt{cone}_{\\eps}(#1)", 1],
xp: ["\\x^{(#1)}_\\prm", 1],
Sn: ["\\Sc^{(#1)}", 1],
Dn: ["\\Dc^{(#1)}", 1],
xt: ["\\x^{(#1)}", 1],
yt: ["y^{(#1)}", 1],
inn: ["\\left<#1\\right>", 1],
yp: ["\\textcolor{red}{ #1}", 1],
zeronorm: ["\\left\\|#1 \\right\\|_0", 1],
unorm: ["\\left\\|#1 \\right\\|_u", 1],
ynorm: ["\\left\\|#1 \\right\\|_{\\bar{y}}", 1],
onetwonorm: ["\\left\\|#1\\right\\|_{1,2}", 1],
opnorm: ["\\left\\|#1\\right\\|", 1],
fronorm: ["\\left\\|#1\\right\\|_{F}", 1],
onenorm: ["\\left\\|#1\\right\\|_{\\ell_1}", 1],
twonorm: ["\\left\\|#1\\right\\|_{\\ell_2}", 1],
Dnorm: ["\\left\\|#1\\right\\|_{D}", 1],
oneinfnorm: ["\\left\\|#1\\right\\|_{1,\\infty}", 1],
infnorm: ["\\left\\|#1\\right\\|_{\\ell_\\infty}", 1],
nucnorm: ["\\left\\|#1\\right\\|_*", 1],
abs: ["\\left|#1\\right|", 1],
avg: ["\\left< #1 \\right>", 1],
xx: ["\\vct{x}^{(#1)}", 1],
Ww: ["\\mtx{W}^{(#1)}", 1],
ejc: ["\\textcolor{emmanuel}{EJC: #1}", 1],
pp: ["{\\vct{p}}(#1)", 1],
pr: ["{\\vct{\\bar{p}}}(#1)", 1],
prl: ["{\\vct{\\tilde{p}}}(#1)", 1],
prb: ["{\\vct{\\bar{p}}}(#1)", 1],
wrb: ["{\\vct{\\bar{W}}}(#1)", 1],
wrt: ["{\\vct{\\bar{W}}}_0(#1)", 1],
sgn: ["\\textrm{sgn}(#1)", 1],
grad: ["{\\nabla\\Lc(#1)}", 1],
gradf: ["{\\nabla f(#1)}", 1],
hessf: ["{\\nabla^2f(#1)}", 1],
gradw: ["{\\nabla{\\Lc}(#1)}", 1],
vct: ["\\bm{#1}", 1],
mtx: ["\\bm{#1}", 1],
rank: ["\\texttt{rank}(#1)", 1],
restrict: ["\\big\\vert_{#1}", 1],
note: ["{\\bf [{\\em Note:} #1]}", 1],
m: ["{\\bf{#1}}", 1],
mb: ["{\\mathbb{#1}}", 1],
fapt: ["f_{\\tsc{cls}}(#1\\bT)", 1],
fapn: ["f_{\\lnk}(#1\\bT)", 1],
zX: ["\\z\\{#1\\}", 1],
aX: ["\\ab\\{#1\\}", 1],
wnorm: ["\\left\\|#1\\right\\|_{#2}", 2],
grd: ["{\\nabla\\Lc_{#1}(#2)}", 2],
iprod: ["\\left\\langle #1 , #2 \\right\\rangle", 2],
ham: ["{\\|#1,#2\\|_H}", 2],
endprf: "\\hfill {\\vrule height6pt width6pt depth0pt}\\medskip"

            },
        },
        options: {
            renderActions: {
                addMenu: []
            },
            ignoreHtmlClass: "tex2jax_ignore",
            skipHtmlTags: ["script", "noscript", "style", "textarea", "pre", "code"]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <header>
        <h1>Theoretical Results on Transformers and Language Models</h1>
        <nav>
            <a href="/">Home</a>
            <a href="/examples">Examples</a>
            <a href="/contact">Contact</a>
            <a href="/contribute">Contribute</a>
            <div class="hover-container">
                <span class="hover-word"><a href="/library">Index</a></span>
                <div class="dropdown-content">
                    <a href="/library">Full Index</a>
                    <a href="/library/papers">Papers</a>
                    <a href="/library/definitions">Definitions</a>
                    <a href="/library/axioms">Axioms</a>
                    <a href="/library/lemmas">Lemmas</a>
                    <a href="/library/theorems">Theorems</a>
                    <a href="/library/corollaries">Corollaries</a>
                </div>
            </div>
        </nav>
    </header>
    <main>
        
<section id="Convergence of Conic Regularization Paths">
    <h2>Theorem 29: Convergence of Conic Regularization Paths</h2>
    <section id="Statement">
        <h3>Statement</h3>
        <div>
            Suppose \eqref{seqattnsvm} is feasible and $\bal=(\al_\ik)\ikix$ are locally-optimal token indices. Suppose Assumptions $\ref{assum:loss:prope}$ \& $\ref{ass cvx seq}$ hold. Recall $\con{\bal}$ of \eqref{cone alpha eq} and consider the norm-constrained cone 
\[
\Ccd:=\con{\bal}\bigcap\{\W\bgl \td{\W}\geq R_0\}.
\]
Define the conic regularization path $\wrb{R}=\min_{\Ccd,\td{\W}\leq R}\Lc(\W)$. Let $\Wcs_{\bal}$ be its set of minima and $\xdm>0$ be the associated margin i.e.~$\xdm=1/\td{\Wcs_{\bal}}$. For any sufficiently small $\eps>0$ and sufficiently large $R_0= \order{1/\eps}>0$, $\lim_{R\rightarrow\infty} \dist{\frac{\wrb{R}}{R\xdm},\Wcs_{\bal}}=0$. Additionally, suppose optimal indices $\op=(\op_\ik)\ikix$ are unique and set $\bal\gets\op$. Then, the same RP convergence guarantee holds with $\Ccd=\Rcm$.
        </div>
    </section>
    <section id="motivation">
        <h3>Motivation of Statement (AI-Generated)</h3>
        <div>
            The given statement provides a convergence guarantee for the conic regularization path in the context of optimization problems involving norm-constrained cones. This result is particularly useful in machine learning and signal processing, where regularization techniques are employed to prevent overfitting and to ensure that solutions generalize well to unseen data. By understanding the behavior of the regularization path as the constraint parameter $R$ grows, practitioners can make informed decisions about the choice of regularization parameters and the expected performance of their models. This theorem is especially relevant when dealing with high-dimensional data and sparse solutions, as it provides insights into the asymptotic properties of the optimization landscape.
        </div>
    </section>
        
<section id="OriginalProof">
<h3>Original Proof</h3>
We will prove that $\wrb{R}$ is the optimal direction and also $\td{\wrb{R}}\rightarrow \infty$. Define the absolute constant 
\[
\cdm=\min_{\td{\W}=1}\tf{\W}.
\]
This guarantees that for any $\W$ we have $\tf{\W}\geq \cdm\td{\W}$. Also denote $\epsd=\cdm\eps$. Let us first determine the $\eps$ parameter: Fix $\Wma\in\Wcs_{\bal}$. For general $\bal$, we can choose any $\eps>0$ that is sufficiently small to guarantee $\Wma\in\con{\bal}$ based on Lemma <a href="/remote/idiap.svm/temp.rea01/sljungbeck/lm_theory_library/lm_theory_library/generated_pages/library/lemmas/lemma_27/index.html#lemma+cone">Lemma 27</a>. For $\bal=\op$, our analysis will entirely avoid using $\eps$, specifically, observe that $\con{\bal}=\Rcm$ based on Lemma <a href="/remote/idiap.svm/temp.rea01/sljungbeck/lm_theory_library/lm_theory_library/generated_pages/library/lemmas/lemma_27/index.html#lemma+cone">Lemma 27</a>.
    
<b>Step 1:</b> Let us first prove that $\wrb{R}$ achieves the optimal risk as $R\rightarrow\infty$ -- rather than problem having finite optima. Define norm-normalized $\Wsb=\xdm\Wma$. Note that $\Wma$ separates tokens $\bal$ from rest of the tokens for each $i,k\in[n]\times [K]$. Thus, we have that
\begin{align}
\lim_{R\rightarrow\infty}\Lc(\wrb{R})\leq\lim_{R\rightarrow\infty}\Lc(R\cdot\Wsb):=\Lc_\star= \frac{1}{n}\sum_{i=1}^n\sum_{k=1}^K\ell(\bga_\ik).\label{asymp loss}
\end{align}
On the other hand, for any choice of $\W\in \con{\bal}$, set $\x^{\W}_\ik=\sum_{t=1}^T \sft{\X_i\W\z_\ik}_t\x_t$. Set softmax probabilities $\sik=\sft{\X_i\W\z_\ik}$. Recalling $\lowi,\higi$ definitions, we can decompose the attention features as
\begin{align}
\x^{\W}_\ik=\sik_{\al_\ik}\xa_\ik+\sum_{t\in\lowi}\sik_t\x_\itt+\sum_{\tau\in\higi}\sik_\tau\x_{\ittt}.
\end{align}
When $\bal=\op$, note that we simply have $\higi=\emptyset$. This will be important for setting $R_0=0$ and $\Ccd=\Rcm$ in the proof for $\op$ indices.

Set $\bgg_\ikt=\bgam_\ikt-\bga_\ik=Y_\ik\cdot (h_k(\x_\itt)-h_k(\xa_\ik))$. Building on $L_h$-Lipschitzness of the prediction head $h_k(\cdot)$, we define
\begin{align}
&B:=\max_{i\in[n],k\in[K]}\max_{t,\tau\in[T]}L_h\cdot \tn{\x_\itt-\x_\ittt}\geq |\bgg_\ikt|.\label{BB eq}
\end{align}

Define $P^\ik:=\sum_{t\in\lowi}\sik_t$, $Q^\ik:=\sum_{t\in\higi}\sik_t$, and $\bgam^{\W}_\ik=Y_\ik\cdot h_k(\x^{\W}_\ik)$. Also set temporary variables $\x'=(\sik_{\al_\ik}+Q^\ik)\xa_\ik+\sum_{t\in\lowi}\sik_t\x_\itt$ and $\bgam'=Y_\ik\cdot h_k(\x^{\W}_\ik)$. 
Using Assumption $\ref{ass cvx seq}$ on $\x'$ and noticing $P^\ik=1-\sik_{\al_\ik}-Q^\ik$, observe that
\[ 
|\bgam^{\W}_\ik-\bgam'|\leq BQ^\ik\quad\text{and}\quad \bgam'\leq \bga_\ik-c_\bal P^\ik. 
\] 
Recall from \eqref{c choice} that, when $h_k$ are linear functions, $c_\bal$ can be chosen as 

\begin{align*}
c_\bal:=\min_{i\in[n],k\in[K]}\min_{t\in\lowi}-\bgg_\ikt>0.
\end{align*}

To summarize, applying Assumption $\ref{ass cvx seq}$, we obtain the following score inequalities
\begin{align}\label{score decomp}
&\bgam^{\W}_\ik\leq \bga_\ik-c_\bal P^\ik+BQ^\ik,\\

&|\bgam^{\W}_\ik-\bga_\ik|\leq L_h\tn{\x^{\W}_\ik-\xa_\ik}\leq L_h \sum_{t\neq \al_\ik}\sik_t\tn{\x_\ikt-\xa_\ik}\leq B(1-\sik_{\al_\ik}).\label{lip score gap}
\end{align}
We will use the $\bgam^{\W}_\ik-\bga_\ik$ term in \eqref{score decomp} to evaluate $\W$ against the reference loss \eqref{asymp loss}. Let $\abik=\X_i\W\z_\ik$. Now since $\W\in \con{\bal}$, there exists $t\in \lowi$ obeying $\abik_t-\max_{\tau\in\higi} \abik_\tau\geq \eps \tf{\W}\geq \epsd\td{\W}$. Denote $D^\ik:=(\sum_{t\in [T]}e^{\abik_t})^{-1}$ to be the softmax denominator i.e.~sum of exponentials. We find that,
\begin{align}
Q^\ik=\sum_{\tau\in\higi}\sik_\tau=D^\ik\sum_{\tau\in\higi}e^{\abik_\tau}\leq D^\ik Te^{\abik_t-\eps\tf{\W}}\leq Te^{-\epsd\td{\W}}P^\ik.\label{qikeq}
\end{align}
Consequently, the score difference obeys

\[
\bgam^{\W}_\ik-\bga_\ik\leq BQ^\ik-c_\bal P^\ik\leq (BTe^{-\epsd\td{\W}}-c_\bal)P^\ik.
\]
Above, the right hand side is strictly negative as soon as $\td{\W}\geq R_0:=\frac{1}{\epsd}\log\frac{BT}{c_\bal}$. Note that, this condition applies to all $(i,k)\in[n]\times [K]$ pairs uniformly for the same $R_0$. Consequently, for any $\td{\W}\geq R_0$, for all $i,k$ and $\W\in \con{\bal}$, we have that $\bgam^{\W}_\ik<\bga_\ik$. Additionally, when $\bal=\op$, note that $Q^\ik=0$ since $\higi=\emptyset$. Thus, $R_0=0$ suffices to ensure $\bgam^{\W}_\ik<\bga_\ik$. Using the strictly-decreasing nature of $\ell$, we conclude with the fact that for all (finite) $\W\in \con{\bal}$, 
\[
\Lc(\W)=\frac{1}{n}\sum_{i=1}^n\sum_{k=1}^K\ell(\bgam^{\W}_\ik)> \Lc_\st=\frac{1}{n}\sum_{i=1}^n\sum_{k=1}^K\ell(\bga_\ik),
\]
which implies $\td{\wrb{R}}\rightarrow\infty$.

<b>Step 2:</b> To proceed, we show that $\wrb{R}$ converges in direction to $\Wcs_{\bal}$. Suppose this is not the case i.e.~convergence fails. We will obtain a contradiction by showing that $\Wsb_R=R\cdot\Wsb$ achieves a strictly superior loss compared to $\wrb{R}$. Also define the normalized parameter $\wrt{R}=\frac{\wrb{R}}{R\xdm}$ and $\W'=\frac{\wrb{R}}{\td{\wrb{R}}\xdm}$. Note that $\wrt{R}$ is obtained by scaling down $\W'$ since $\td{\wrb{R}}\leq R$ and $\W'$ obeys $\td{\W'}=\td{\Wma}$.

Since $\wrt{R}$ fails to converge to $\Wcs_{\bal}$, for some $\delta>0$, there exists arbitrarily large $R>0$ such that $\dist{\wrt{R},\Wcs_{\bal}}\geq \delta$. This translates to the suboptimality in terms of margin constraints as follows: First, distance with respect to the $\dm$-norm obeys $\distd{\wrt{R},\Wcs_{\bal}}\geq \delta$ for some updated $\delta\gets \cdm\delta$. Secondly, using triangle inequality,
\[ 
\text{This implies that either~~~}\td{\wrt{R}}\leq \td{\Wma}-\delta/2\text{~~~or~~~}\distd{\W',\Wcs_{\bal}}\geq \delta/2.
\]
In either scenario, $\wrt{R}$ strictly violates one of the margin constraints of \eqref{seqattnsvm}: If $\td{\wrt{R}}\leq \td{\Wma}-\delta/2$, then, since the optimal SVM objective is $\td{\Wma}$, there exists a constraint $(i,k)$ for which $\inn{\Fa_{\ik}-\F_{\ikt},\wrt{R}}\leq 1-\frac{\delta}{2\td{\Wma}}$. If $\distd{\W',\Wcs_{\bal}}\geq \delta/2$, then, $\W'$ has same SVM objective but it is strictly bounded away from the solution set. Thus, for some $\eps:=\eps(\delta)>0$, $\W'$ and its scaled down version $\wrt{R}$ strictly violate an SVM constraint achieving margin $\leq 1-\eps$. Without losing generality, suppose $\wrt{R}$ violates the first constraint. Thus, for a properly updated $\delta>0$ (that is function of the initial $\delta>0$) and for $(i,k)=(1,1)$ and some \nei $\tau\in \Tc_\oo$,
\begin{align}
\inn{\Fa_{\oo}-\F_{\oo t},\wrt{R}}\leq 1-\delta.\label{margin violate}
\end{align}
Now, we will argue that this will lead to a contradiction by proving $\Lc(\Wsb_R)<\Lc(\wrb{R})$ for sufficiently large $R$.

To obtain the result, we establish a refined softmax probability control as in Step 1 by studying distance to $\Lc_\star$. Following \eqref{score decomp}, denote the score function at $\wrb{R}$ via $\bgam^R_\ik=\bgam_\ik^{\wrb{R}}$ as shorthand notation. Similarly, let $\sir_\ik=\sft{\abr_\ik}$ with $\abr_\ik=\X_i\wrb{R}\z_\ik$. Set the corresponding notation for the reference parameter $\Wsb_R$ as $\bgam^\st_\ik,\s^\st_\ik,\ab^\st_\ik$. 

Critically, recall the above inequalities \eqref{qikeq} that applies to both $\W\in\{\wrb{R},\Wsb_R\}\subset\con{\bal}$ for an index $(i,k)$ and \nei $t\in\Tc_\ik$
\begin{align}
\nonumber 
Q^\ik&=\sum_{\tau\in\higi}\s_\iktt=D^\ik\sum_{\tau\in\higi}e^{\ab_{\iktt}} \\
&\leq D^\ik Te^{\ab_\ikt-\epsd\td{\W}}\leq Te^{-\epsd\td{\W}}P^\ik\leq Te^{-\epsd\td{\W}}(1-\s_{\ik\al_\ik}), \label{qik bound}
\end{align}
where $P^\ik=\sum_{\tau\in\lowi}\s_{\iktt}$ and $P^\ik+Q^\ik= 1-\s_{\ik\al_\ik}$. 

Note that, setting $R_0\geq \order{1/\epsd}=\order{1/\eps}$, we guarantee that, for any $(i,k)\in[n]\times [K]$
\begin{align}
P^\ik\geq Q^\ik\implies P^\ik \geq 0.5(1-\s_{\ik\al_\ik}). \label{pik bound}
\end{align}
Additionally, when $\bal=\op$, note that $Q^\ik=0$ since $\higi=\emptyset$. Thus, $R_0=0$ suffices to ensure \eqref{pik bound}.

To proceed, recall that $R\geq \td{\wrb{R}}\geq R_0$ by definition since $\wrb{R}\in \Ccd$ and recall $\xdm:=1/\td{\Wma}$. Equipped with these, we note the following softmax inequalities on the selected tokens $\al_\ik$
\begin{align}
&\s^\st_{\ik\al_\ik}\geq \frac{1}{1+Te^{-R\xdm}}\geq 1-Te^{-R\xdm}\quad \text{for all}\quad (i,k)\in[n]\times [K], \label{salpha bounds}\\
&s^R_{\ik\al_\ik}\leq \frac{1}{1+e^{-(1-\delta)\td{\wrb{R}}\xdm}}\leq \frac{1}{1+e^{-(1-\delta)R\xdm}}\quad\text{for}\quad (i,k)=(1,1).\nn
\end{align}
The former inequality is thanks to $\Wma$ achieving $\geq 1$ margins on all tokens $[T]-\al_\ik$ and the latter arises from the $\delta$-margin violation of $\wrb{R}$ at $(i,k)=(1,1)$ i.e.~Eq.~\eqref{margin violate}. Since $\ell$ is strictly decreasing with Lipschitz gradient and the scores are upper/lower bounded by an absolute constant (as tokens are bounded, $(h_k)_{k=1}^K$ are Lipschitz, and both are fixed), we know that $\cop\geq -\ell'(\bgam_\ik^{\W})\geq \cdn$ for some constants $\cop>\cdn>0$. Thus, following Eq.~\eqref{BB eq} and the score decomposition \eqref{score decomp}, and using \eqref{qik bound},\eqref{pik bound},\eqref{salpha bounds} we can write
\begin{align}
\nonetheless
\Lc(\wrb{R})-\Lc_\star&\geq \frac{1}{n}[\ell(\bgam_\oo^{\wrb{R}})-\ell(\bga_\oo)]\geq \frac{\cdn}{n}(\bga_{\oo}-\bgam_\oo^{\wrb{R}})\\
&\geq \frac{\cdn}{n}(c_\bal P^\oo_{\wrb{R}}-BQ^\oo_{\wrb{R}})\label{q11 eq}\\
&\geq \frac{\cdn}{n}(1-\s_{\oo\al_\oo}^R)(0.5c_\bal -BTe^{-\epsd \td{\wrb{R}}}) \nonetheless\\
\nonetheless
&\geq \frac{\cdn}{n}\frac{1}{1+e^{(1-\delta)R\xdm}}(0.5c_\bal-BTe^{-\epsd R_0}).
\end{align}
Above, recalling the choice $R_0\geq \order{1/\epsd}=\order{1/\eps}$, $R\geq R_0$ implies $BTe^{-\epsd R_0}\leq c_\bal/4$ to obtain
\begin{align}
\Lc(\wrb{R})-\Lc_\star\geq \frac{\cdn\cdot c_\bal}{4n}\frac{1}{1+e^{(1-\delta)R\xdm}}.\label{ineq prl}
\end{align}
Additionally when $\bal=\op$, since $Q^\oo_{\wrb{R}}=0$ in \eqref{q11 eq}, the bound above holds with $R_0=0$ by directly using \eqref{q11 eq}.

Conversely, we upper bound the difference between $\Lc(\Wsb_R)$ and $\Lc_\star$ as follows. Define the worst-case loss difference for $\wrb{R}$ as $(i',k')=\arg\max_{i\in[n],k\in[K]}[\ell(\bgam_\ik^\st)-\ell(\bga_\ik)]$. Using \eqref{lip score gap}\&\eqref{salpha bounds}, we write

\begin{equation}
\begin{aligned}
\Lc(\Wsb_R)-\Lc_\star&\leq \max_{i\in[n],k\in[K]}[\ell(\bgam_\ik^\st)-\ell(\bga_\ik)]\leq \cop\cdot(\bga_{i'k'}-\bgam^\st_{i'k'})\\
&\leq \cop\cdot(1-\s_{i'k'\al_{i'k'}}^\st)B\\
&\leq \cop\cdot Te^{-R\xdm}B.\label{desired Wmm bound}
\end{aligned}
\end{equation}
Combining the last inequality and
</section>

    <section id="proofExplanation">
        <h4>Explanation of Proof (AI-Generated)</h4>
        <div>
            To understand the proof, let's break it down into several steps:
<br>
<br>1. <i>Definition of Constants</i>: The proof begins by defining the absolute constant \(\cdm\) and the parameter \(\epsd\):
<br>   \[
   \cdm=\min_{\td{\W}=1}\tf{\W}, \quad \epsd=\cdm\eps.
   \]
<br>   This ensures that for any \(\W\), \(\tf{\W}\geq \cdm\td{\W}\).
<br>
<br>2. <i>Parameter \(\eps\) Selection</i>: The parameter \(\eps\) is chosen to ensure \(\Wma\in\con{\bal}\) based on Lemma 27. For \(\bal=\op\), \(\eps\) is not used, and \(\con{\bal}=\Rcm\).
<br>
<br>3. <i>Optimal Risk Achievement</i>: The proof shows that \(\wrb{R}\) achieves the optimal risk as \(R\rightarrow\infty\):
<br>   \[
   \lim_{R\rightarrow\infty}\Lc(\wrb{R})\leq\lim_{R\rightarrow\infty}\Lc(R\cdot\Wsb):=\Lc_\star= \frac{1}{n}\sum_{i=1}^n\sum_{k=1}^K\ell(\bga_\ik).
   \]
<br>
<br>4. <i>Score Decomposition</i>: The attention features are decomposed, and the score differences are bounded using the Lipschitz property of \(h_k\):
<br>   \[
   \bgam^{\W}_\ik\leq \bga_\ik-c_\bal P^\ik+BQ^\ik, \quad |\bgam^{\W}_\ik-\bga_\ik|\leq B(1-\sik_{\al_\ik}).
   \]
<br>
<br>5. <i>Softmax Probability Control</i>: The softmax probabilities are controlled to ensure that for large \(R\), the score differences are bounded:
<br>   \[
   Q^\ik\leq Te^{-\epsd\td{\W}}P^\ik, \quad P^\ik\geq 0.5(1-\s_{\ik\al_\ik}).
   \]
<br>
<br>6. <i>Margin Violation</i>: It is shown that if \(\wrt{R}\) does not converge to \(\Wcs_{\bal}\), it violates the margin constraints:
<br>   \[
   \inn{\Fa_{\oo}-\F_{\oo t},\wrt{R}}\leq 1-\delta.
   \]
<br>
<br>7. <i>Loss Comparison</i>: The loss of \(\wrb{R}\) is compared to \(\Wsb_R\) to show that \(\wrb{R}\) achieves a strictly superior loss:
<br>   \[
   \Lc(\wrb{R})-\Lc_\star\geq \frac{\cdn\cdot c_\bal}{4n}\frac{1}{1+e^{(1-\delta)R\xdm}}, \quad \Lc(\Wsb_R)-\Lc_\star\leq \cop\cdot Te^{-R\xdm}B.
   \]
<br>
<br>Thus, the proof shows that \(\wrb{R}\) is the optimal direction and \(\td{\wrb{R}}\rightarrow \infty\).
        </div>
    </section>


    <section id="Corollaries">
    <h3>Corollaries</h3>
    <p><a href="/library/corollaries/corollary_2/index.html">Corollary 2</a> and <a href="/library/corollaries/corollary_3/index.html">Corollary 3</a></p>
    </section>



    <section id="Reference">
        <h3>Reference</h3>
            <p>Title: <a href="/library/papers/transformers_as_support_vector_machines/index.html">Transformers as Support Vector Machines</a></p>
            <p>Authors: Davoud Ataee Tarzanagh, Yingcong Li, Christos Thrampoulidis, and Samet Oymak</p>
            <p>URL: <a href="https://arxiv.org/abs/2308.16898">https://arxiv.org/abs/2308.16898</a></p>
    </section>
    <section id="Resources">
        <!-- Bibtex Modal -->
        <div id="bibtexModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBibtexModal()">&times;</span>
            <p>@misc{tarzanagh2024transformerssupportvectormachines,<br>&emsp;title={Transformers as Support Vector Machines},<br>&emsp;author={Davoud Ataee Tarzanagh and Yingcong Li and Christos Thrampoulidis and Samet Oymak},<br>&emsp;year={2024},<br>&emsp;eprint={2308.16898},<br>&emsp;archivePrefix={arXiv},<br>&emsp;primaryClass={cs.LG},<br>&emsp;url={https://arxiv.org/abs/2308.16898}<br>}</p>
            <button class="modal-button" onclick="copyBibtex()">Copy</button>
        </div>
        </div>

        <!-- Latex Modal -->
        <div id="latexModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeLatexModal()">&times;</span>
            <p class="tex2jax_ignore"><code>\begin{theorem} [Convergence of Local Regularization Path]\label{local RP thm} Suppose \eqref{seqattnsvm} is feasible and $\bal=(\al_\ik)\ikix$ are locally-optimal token indices. Suppose Assumptions \ref{assum:loss:prope}\&\ref{ass cvx seq} hold. Recall $\con{\bal}$ of \eqref{cone alpha eq} and consider the norm-constrained cone \[
\Ccd:=\con{\bal}\bigcap\{\W\bgl \td{\W}\geq R_0\}.
\]
Define the conic regularization path $\wrb{R}=\min_{\Ccd,\td{\W}\leq R}\Lc(\W)$. Let $\Wcs_{\bal}$ be its set of minima and $\xdm>0$ be the associated margin i.e.~$\xdm=1/\td{\Wcs_{\bal}}$. For any sufficiently small $\eps>0$ and sufficiently large $R_0= \order{1/\eps}>0$, $\lim_{R\rightarrow\infty} \dist{\frac{\wrb{R}}{R\xdm},\Wcs_{\bal}}=0$. Additionally, suppose optimal indices $\op=(\op_\ik)\ikix$ are unique and set $\bal\gets\op$. Then, the same RP convergence guarantee holds with $\Ccd=\Rcm$.
\end{theorem}</code></p>
            <button class="modal-button" onclick="copyLatex()">Copy</button>
        </div>
        </div>

        <h3>Resources</h3>    
            <p>
                <b>BibTex</b>:
                    <button onclick="copyBibtex()">Copy</button>
                    <button onclick="openBibtexModel()">Show</button>
            </p>
            <p>
                <b>LaTeX</b>:
                    <button onclick="copyLatex()">Copy</button>
                    <button onclick="openLatexModal()">Show</button>
            </p>
        <script>
            function copyBibtex() {
                var textToCopy = `@misc{tarzanagh2024transformerssupportvectormachines,
  title={Transformers as Support Vector Machines},
  author={Davoud Ataee Tarzanagh and Yingcong Li and Christos Thrampoulidis and Samet Oymak},
  year={2024},
  eprint={2308.16898},
  archivePrefix={arXiv},
  primaryClass={cs.LG},
  url={https://arxiv.org/abs/2308.16898}
}`;
                navigator.clipboard.writeText(textToCopy).then(function() {
                    //alert('Text copied to clipboard: ' + textToCopy);
                }, function(err) {
                    console.error('Failed to copy text: ', err);
                });
            }
            
            function copyLatex() {
                var textToCopy = `\\begin{theorem} [Convergence of Local Regularization Path]\\label{local RP thm} Suppose \\eqref{seqattnsvm} is feasible and $\\bal=(\\al_\\ik)\\ikix$ are locally-optimal token indices. Suppose Assumptions \\ref{assum:loss:prope}\\&\\ref{ass cvx seq} hold. Recall $\\con{\\bal}$ of \\eqref{cone alpha eq} and consider the norm-constrained cone \\[
\\Ccd:=\\con{\\bal}\\bigcap\\{\\W\\bgl \\td{\\W}\\geq R_0\\}.
\\]
Define the conic regularization path $\\wrb{R}=\\min_{\\Ccd,\\td{\\W}\\leq R}\\Lc(\\W)$. Let $\\Wcs_{\\bal}$ be its set of minima and $\\xdm>0$ be the associated margin i.e.~$\\xdm=1/\\td{\\Wcs_{\\bal}}$. For any sufficiently small $\\eps>0$ and sufficiently large $R_0= \\order{1/\\eps}>0$, $\\lim_{R\\rightarrow\\infty} \\dist{\\frac{\\wrb{R}}{R\\xdm},\\Wcs_{\\bal}}=0$. Additionally, suppose optimal indices $\\op=(\\op_\\ik)\\ikix$ are unique and set $\\bal\\gets\\op$. Then, the same RP convergence guarantee holds with $\\Ccd=\\Rcm$.
\\end{theorem}`;
                navigator.clipboard.writeText(textToCopy).then(function() {
                    //alert('Text copied to clipboard: ' + textToCopy);
                }, function(err) {
                    console.error('Failed to copy text: ', err);
                });
            }

            // Bibtex
            function openBibtexModel() {
                document.getElementById('bibtexModal').style.display = 'block';
            }
            function closeBibtexModal() {
                document.getElementById('bibtexModal').style.display = 'none';
            }

            // Latex
            function openLatexModal() {
                document.getElementById('latexModal').style.display = 'block';
            }
            function closeLatexModal() {
                document.getElementById('latexModal').style.display = 'none';
            }
        </script>
    </section>
</section>

    </main>
    <footer>
        <p>&copy; 2024 Theoretical Results on Transformers and Language Models</p>
    </footer>
</body>
</html>